# Example: Secrets Allow List
#
# Configure exceptions for the secrets validator to allow intentional
# test secrets and fixtures without triggering false positives.
#
# Usage:
#   Copy to ~/.klaudiush/config.toml (global) or .klaudiush/config.toml (project)

[rules]
enabled = true
stop_on_first_match = true

# Allow secrets in test directories
#
# Test fixtures often contain fake credentials for testing purposes.
# This rule allows secrets detection to pass for these files.
[[rules.rules]]
name = "allow-test-secrets"
description = "Allow secrets in test fixtures"
enabled = true
priority = 1000  # High priority to match first

[rules.rules.match]
validator_type = "secrets.secrets"
file_pattern = "**/test/**"

[rules.rules.action]
type = "allow"
message = "Test fixture secrets allowed"

# Allow secrets in testdata directories
[[rules.rules]]
name = "allow-testdata-secrets"
description = "Allow secrets in testdata directories"
enabled = true
priority = 1000

[rules.rules.match]
validator_type = "secrets.secrets"
file_pattern = "**/testdata/**"

[rules.rules.action]
type = "allow"
message = "Testdata secrets allowed"

# Allow secrets in fixture files
[[rules.rules]]
name = "allow-fixture-secrets"
description = "Allow secrets in fixture files"
enabled = true
priority = 1000

[rules.rules.match]
validator_type = "secrets.secrets"
file_pattern = "**/*fixture*"

[rules.rules.action]
type = "allow"
message = "Fixture secrets allowed"

# Allow secrets in mock files
[[rules.rules]]
name = "allow-mock-secrets"
description = "Allow secrets in mock files"
enabled = true
priority = 1000

[rules.rules.match]
validator_type = "secrets.secrets"
file_pattern = "**/*mock*"

[rules.rules.action]
type = "allow"
message = "Mock secrets allowed"

# Allow secrets in example/sample files
[[rules.rules]]
name = "allow-example-secrets"
description = "Allow secrets in example/sample files"
enabled = true
priority = 1000

[rules.rules.match]
validator_type = "secrets.secrets"
file_pattern = "**/examples/**"

[rules.rules.action]
type = "allow"
message = "Example secrets allowed"

# Allow .env.example files (intentionally contain placeholder secrets)
[[rules.rules]]
name = "allow-env-example"
description = "Allow secrets in .env.example files"
enabled = true
priority = 1000

[rules.rules.match]
validator_type = "secrets.secrets"
file_pattern = "**/.env.example"

[rules.rules.action]
type = "allow"
message = "Example env file secrets allowed"
