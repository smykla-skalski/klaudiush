# SEC003: Private Key Detected

## Error

Detected a private key in the code.

## Why This Matters

- Private keys enable impersonation and decryption
- SSH keys grant server access
- PGP keys can forge signatures
- TLS keys compromise encrypted communications
- Key exposure requires immediate rotation

## Detected Patterns

This error is triggered by:

- RSA Private Keys (`-----BEGIN RSA PRIVATE KEY-----`)
- DSA Private Keys (`-----BEGIN DSA PRIVATE KEY-----`)
- EC Private Keys (`-----BEGIN EC PRIVATE KEY-----`)
- OpenSSH Private Keys (`-----BEGIN OPENSSH PRIVATE KEY-----`)
- PGP Private Key Blocks (`-----BEGIN PGP PRIVATE KEY BLOCK-----`)

## How to Fix

1. **Remove the key from the repository immediately**

2. **Store keys securely:**
   - Use SSH agent or keychain
   - Store in encrypted vaults
   - Use cloud KMS for encryption keys

3. **Use environment-based key loading:**

   ```go
   keyPath := os.Getenv("PRIVATE_KEY_PATH")
   key, err := os.ReadFile(keyPath)
   ```

4. **Rotate compromised keys:**
   - Generate new keys
   - Update all systems using the old key
   - Revoke the old key

## Configuration

If the key is for testing (e.g., in test fixtures):

```toml
[validators.secrets]
disabled_patterns = ["private-key-rsa"]
```

Or allow specific test key patterns:

```toml
[validators.secrets]
allow_list = [
    "test[_-]key",
    "example[_-]key",
]
```

## Git History Cleanup

If a key was committed, use git-filter-repo to remove it:

```bash
git filter-repo --invert-paths --path path/to/private.key
```

## Related

- [SEC001](SEC001.md) - API Key Detected
- [SEC004](SEC004.md) - Token Detected
