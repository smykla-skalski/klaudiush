# SEC005: Connection String with Credentials Detected

## Error

Detected a database connection string containing embedded credentials.

## Why This Matters

- Connection strings expose both location and credentials
- Database access enables data theft or destruction
- Credentials often grant broader access than intended
- Connection strings in logs create additional exposure

## Detected Patterns

This error is triggered by:

- MongoDB: `mongodb://user:pass@host/db`
- MongoDB+SRV: `mongodb+srv://user:pass@host/db`
- PostgreSQL: `postgres://user:pass@host/db`
- MySQL: `mysql://user:pass@host/db`
- Redis: `redis://user:pass@host/db`

## How to Fix

1. **Use environment variables for the full connection string:**

   ```go
   connStr := os.Getenv("DATABASE_URL")
   ```

2. **Or compose from separate environment variables:**

   ```go
   host := os.Getenv("DB_HOST")
   user := os.Getenv("DB_USER")
   pass := os.Getenv("DB_PASSWORD")
   connStr := fmt.Sprintf("postgres://%s:%s@%s/mydb", user, pass, host)
   ```

3. **Use IAM-based authentication:**
   - AWS RDS IAM authentication
   - GCP Cloud SQL IAM
   - Azure AD authentication

## Configuration

Allow example connection strings:

```toml
[validators.secrets]
allow_list = [
    "mongodb://localhost.*",
    "postgres://.*@localhost.*",
    "mysql://root:root@localhost.*",
]
```

## Best Practices

- Use connection pooling services (PgBouncer, ProxySQL)
- Implement database credential rotation
- Use read-only credentials where possible
- Enable TLS for database connections

## Related

- [SEC001](SEC001.md) - API Key Detected
- [SEC002](SEC002.md) - Hardcoded Password Detected
