# SEC004: Token Detected

## Error

Detected what appears to be an authentication token in the code.

## Why This Matters

- Tokens provide authenticated access to services
- Many tokens have broad permissions
- Exposed tokens are actively exploited by attackers
- Tokens in git history remain recoverable

## Detected Patterns

This error is triggered by:

- GitHub Personal Access Tokens (`ghp_...`)
- GitHub OAuth Tokens (`gho_...`)
- GitHub App Tokens (`ghu_...`, `ghs_...`)
- GitHub Refresh Tokens (`ghr_...`)
- GitLab Personal Access Tokens (`glpat-...`)
- Slack Tokens (`xoxb-...`, `xoxa-...`, etc.)
- Slack Webhook URLs
- NPM Tokens (`npm_...`)
- JSON Web Tokens (JWTs)

## How to Fix

1. **Remove the token immediately**

2. **Revoke the compromised token:**
   - GitHub: Settings > Developer settings > Personal access tokens
   - GitLab: Settings > Access Tokens
   - Slack: App settings > OAuth & Permissions

3. **Use environment variables:**

   ```go
   token := os.Getenv("GITHUB_TOKEN")
   ```

4. **Use credential helpers:**

   ```bash
   # For git credentials
   git config credential.helper store
   ```

## Configuration

Allow test tokens:

```toml
[validators.secrets]
allow_list = [
    "ghp_test.*",
    "xoxb-000000000000-000000000000.*",  # Slack example token
]
```

## Best Practices

- Use short-lived tokens when possible
- Apply minimum necessary permissions
- Use OAuth apps over personal tokens
- Implement token rotation policies

## Related

- [SEC001](SEC001.md) - API Key Detected
- [SEC003](SEC003.md) - Private Key Detected
