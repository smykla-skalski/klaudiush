# SEC001: API Key Detected

## Error

Detected what appears to be an API key or service credential in the code.

## Why This Matters

- API keys grant access to paid services and resources
- Exposed keys can be scraped from git history
- Attackers actively scan public repositories for credentials
- Keys can be used for financial theft or service abuse

## Detected Patterns

This error is triggered by:

- AWS Access Key IDs (`AKIA...`)
- AWS Secret Access Keys
- Google API Keys (`AIza...`)
- GCP Service Account JSON
- Stripe API Keys (`sk_live_...`, `pk_live_...`)
- SendGrid API Keys (`SG....`)
- Twilio API Keys (`SK...`)
- Mailgun API Keys (`key-...`)
- Heroku API Keys
- Azure Storage Account Keys
- Generic secret/api_key assignments

## How to Fix

1. **Remove the key from code immediately**

2. **Use environment variables:**

   ```go
   apiKey := os.Getenv("SERVICE_API_KEY")
   ```

3. **Use secret management services:**
   - AWS Secrets Manager
   - HashiCorp Vault
   - GCP Secret Manager
   - Azure Key Vault
   - 1Password Secrets Automation

4. **Rotate compromised keys** - If the key was ever committed, treat it as compromised and rotate it.

## Configuration

Add to allow list if this is a test key or false positive:

```toml
[validators.secrets]
allow_list = [
    "AKIAIOSFODNN7EXAMPLE",  # AWS example key from docs
    "test_.*",               # Regex for test keys
]
```

Disable specific patterns:

```toml
[validators.secrets]
disabled_patterns = ["generic-secret"]  # High false positive pattern
```

## Related

- [SEC002](SEC002.md) - Hardcoded Password
- [SEC004](SEC004.md) - Token Detected
